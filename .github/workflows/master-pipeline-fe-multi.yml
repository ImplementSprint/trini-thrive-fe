# Template: FE Multi Pipeline Caller (for other repositories)
# Copy this file to: .github/workflows/master-pipeline-fe-multi.yml in the target repo.
#
# IMPORTANT:
# - Update the `uses` repository/ref below to point to your central pipeline repo.
# - Keep all CI/CD logic inside the called master orchestrator workflow.

name: "Master Pipeline Caller â€” FE Multi"

on:
  push:
    branches: [test, uat, main]
  pull_request:
    branches: [test, uat, main]
  workflow_dispatch:
    inputs:
      run_deploy:
        description: "Run deploy jobs"
        type: boolean
        default: true
      run_promotion:
        description: "Run PR promotion jobs"
        type: boolean
        default: true
      dry_run:
        description: "Preview-only mode (skip deploy/tag push, print PR body)"
        type: boolean
        default: false

permissions:
  contents: write
  packages: write
  pull-requests: write
  security-events: write

concurrency:
  group: master-pipeline-fe-multi-caller-${{ github.ref }}
  cancel-in-progress: true

jobs:
  master-orchestrator:
    if: ${{ github.event.repository.name != 'central-workflow' }}
    name: "Call Unified Master Orchestrator"
    uses: ImplementSprint/central-workflow/.github/workflows/master-pipeline-fe.yml@main
    with:
      pipeline_mode: multi
      run_deploy: ${{ github.event_name != 'workflow_dispatch' || github.event.inputs.run_deploy == 'true' }}
      run_promotion: ${{ github.event_name != 'workflow_dispatch' || github.event.inputs.run_promotion == 'true' }}
      dry_run: ${{ github.event_name == 'workflow_dispatch' && github.event.inputs.dry_run == 'true' }}
    secrets: inherit
